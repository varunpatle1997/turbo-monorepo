import closeWithGrace from 'close-with-grace';
import { createApp } from './app.js';
import { env } from './env.js';
const app = createApp({
    trustProxy: true,
    bodyLimit: env.get().BODY_LIMIT,
});
closeWithGrace({ delay: 10000 }, async function ({ err, signal }) {
    if (err) {
        app.log.error(err);
    }
    app.log.info(`[${signal}] Gracefully closing the server instance.`);
    await app.close();
});
app.listen({ host: '0.0.0.0', port: env.get().PORT }, (err) => {
    if (err) {
        app.log.error(err);
        process.exit(1);
    }
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi9zcmMvaW5kZXgudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxjQUFjLE1BQU0sa0JBQWtCLENBQUE7QUFFN0MsT0FBTyxFQUFFLFNBQVMsRUFBRSxNQUFNLFVBQVUsQ0FBQTtBQUNwQyxPQUFPLEVBQUUsR0FBRyxFQUFFLE1BQU0sVUFBVSxDQUFBO0FBRTlCLE1BQU0sR0FBRyxHQUFHLFNBQVMsQ0FBQztJQUNwQixVQUFVLEVBQUUsSUFBSTtJQUdoQixTQUFTLEVBQUUsR0FBRyxDQUFDLEdBQUcsRUFBRSxDQUFDLFVBQVU7Q0FDaEMsQ0FBQyxDQUFBO0FBRUYsY0FBYyxDQUNaLEVBQUUsS0FBSyxFQUFFLEtBQUssRUFBRSxFQUNoQixLQUFLLFdBQVcsRUFBRSxHQUFHLEVBQUUsTUFBTSxFQUFvQztJQUMvRCxJQUFJLEdBQUcsRUFBRTtRQUNQLEdBQUcsQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFBO0tBQ25CO0lBRUQsR0FBRyxDQUFDLEdBQUcsQ0FBQyxJQUFJLENBQUMsSUFBSSxNQUFNLDJDQUEyQyxDQUFDLENBQUE7SUFFbkUsTUFBTSxHQUFHLENBQUMsS0FBSyxFQUFFLENBQUE7QUFDbkIsQ0FBQyxDQUNGLENBQUE7QUFFRCxHQUFHLENBQUMsTUFBTSxDQUFDLEVBQUUsSUFBSSxFQUFFLFNBQVMsRUFBRSxJQUFJLEVBQUUsR0FBRyxDQUFDLEdBQUcsRUFBRSxDQUFDLElBQUksRUFBRSxFQUFFLENBQUMsR0FBRyxFQUFFLEVBQUU7SUFDNUQsSUFBSSxHQUFHLEVBQUU7UUFDUCxHQUFHLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQTtRQUNsQixPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFBO0tBQ2hCO0FBQ0gsQ0FBQyxDQUFDLENBQUEifQ==