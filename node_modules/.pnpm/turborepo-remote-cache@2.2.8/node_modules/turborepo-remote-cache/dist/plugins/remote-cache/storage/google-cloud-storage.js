import GCS from '@google-cloud/storage';
function createStorage({ clientEmail, privateKey, projectId }) {
    if (!clientEmail || !privateKey || !projectId) {
        return new GCS.Storage();
    }
    else {
        return new GCS.Storage({
            projectId,
            credentials: {
                client_email: clientEmail,
                private_key: privateKey,
            },
        });
    }
}
export function createGoogleCloudStorage({ bucket, clientEmail, privateKey, projectId, }) {
    const storage = createStorage({
        clientEmail,
        privateKey,
        projectId,
    });
    const turboBucket = storage.bucket(bucket);
    return {
        exists: (artifactPath, cb) => {
            turboBucket.file(artifactPath).exists(cb);
        },
        createReadStream(artifactPath) {
            return turboBucket
                .file(artifactPath)
                .createReadStream();
        },
        createWriteStream(artifactPath) {
            return turboBucket.file(artifactPath).createWriteStream();
        },
    };
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZ29vZ2xlLWNsb3VkLXN0b3JhZ2UuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi9zcmMvcGx1Z2lucy9yZW1vdGUtY2FjaGUvc3RvcmFnZS9nb29nbGUtY2xvdWQtc3RvcmFnZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEdBQUcsTUFBTSx1QkFBdUIsQ0FBQTtBQVV2QyxTQUFTLGFBQWEsQ0FBQyxFQUFFLFdBQVcsRUFBRSxVQUFVLEVBQUUsU0FBUyxFQUFFO0lBQzNELElBQUksQ0FBQyxXQUFXLElBQUksQ0FBQyxVQUFVLElBQUksQ0FBQyxTQUFTLEVBQUU7UUFDN0MsT0FBTyxJQUFJLEdBQUcsQ0FBQyxPQUFPLEVBQUUsQ0FBQTtLQUN6QjtTQUFNO1FBQ0wsT0FBTyxJQUFJLEdBQUcsQ0FBQyxPQUFPLENBQUM7WUFDckIsU0FBUztZQUNULFdBQVcsRUFBRTtnQkFDWCxZQUFZLEVBQUUsV0FBVztnQkFDekIsV0FBVyxFQUFFLFVBQVU7YUFDeEI7U0FDRixDQUFDLENBQUE7S0FDSDtBQUNILENBQUM7QUFFRCxNQUFNLFVBQVUsd0JBQXdCLENBQUMsRUFDdkMsTUFBTSxFQUNOLFdBQVcsRUFDWCxVQUFVLEVBQ1YsU0FBUyxHQUNpQjtJQUMxQixNQUFNLE9BQU8sR0FBRyxhQUFhLENBQUM7UUFDNUIsV0FBVztRQUNYLFVBQVU7UUFDVixTQUFTO0tBQ1YsQ0FBQyxDQUFBO0lBRUYsTUFBTSxXQUFXLEdBQUcsT0FBTyxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQTtJQUUxQyxPQUFPO1FBQ0wsTUFBTSxFQUFFLENBQUMsWUFBWSxFQUFFLEVBQUUsRUFBRSxFQUFFO1lBQzNCLFdBQVcsQ0FBQyxJQUFJLENBQUMsWUFBWSxDQUFDLENBQUMsTUFBTSxDQUFDLEVBQUUsQ0FBQyxDQUFBO1FBQzNDLENBQUM7UUFDRCxnQkFBZ0IsQ0FBQyxZQUFZO1lBQzNCLE9BQU8sV0FBVztpQkFDZixJQUFJLENBQUMsWUFBWSxDQUFDO2lCQUNsQixnQkFBZ0IsRUFBdUIsQ0FBQTtRQUM1QyxDQUFDO1FBQ0QsaUJBQWlCLENBQUMsWUFBWTtZQUM1QixPQUFPLFdBQVcsQ0FBQyxJQUFJLENBQUMsWUFBWSxDQUFDLENBQUMsaUJBQWlCLEVBQUUsQ0FBQTtRQUMzRCxDQUFDO0tBQ0YsQ0FBQTtBQUNILENBQUMifQ==